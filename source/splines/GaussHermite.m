% By C. Mollet
%
% Gauss-Legende Quadrature of Ordnung k (exactness up to degree 2k-1).
% Adapted to weight function w(x):=1/sqrt(2*pi)+exp(-x^2/2)
%
% Input:
% ------
% 'f'        : Integrand evaluated as Gauss-Hermite points
% 'order'    : Order
%
% Output:
% -------
% 'val'  : 1/sqrt(2*pi) * \int_a^b exp(-x^2/2)f dx (resp. approx.)
%


function val = GaussHermite(f,order)

invsqrtpi = 1/sqrt(pi);

% setting weights of order 13, 14, 15
% Values taken from: http://keisan.casio.com/exec/system/1281195844

alpha13 = [4.82573185007313108835E-8 ...
    2.04303604027070731249E-5...
    0.001207459992719385947309 ...
    0.0208627752961699392166 ...
    0.1403233206870234377628 ...
    0.4216162968985432217469 ...
    0.6043931879211616423421 ...
    0.4216162968985432217469 ...
    0.1403233206870234377628 ...
    0.0208627752961699392166 ...
    0.001207459992719385947309 ...
    2.04303604027070731249E-5 ...
    4.82573185007313108835E-8];

alpha14 = [ 8.6285911681251579453E-9 ...
    4.71648435501891674888E-6 ...
    3.550926135519236104837E-4 ...
    0.00785005472645794431049 ...
    0.0685055342234652055387 ...
    0.2731056090642466033526 ...
    0.5364059097120901497949 ...
    0.5364059097120901497949 ...
    0.2731056090642466033526 ...
    0.0685055342234652055387 ...
    0.00785005472645794431049 ...
    3.550926135519236104837E-4 ...
    4.71648435501891674888E-6 ...
    8.6285911681251579453E-9];



alpha15 = [ 1.52247580425351702016E-9 ...
    1.059115547711066635775E-6 ...
    1.000044412324998681273E-4 ...
    0.0027780688429127758961 ...
    0.0307800338725460822287 ...
    0.1584889157959357468838 ...
    0.4120286874988986270259 ...
    0.5641003087264175328526 ...
    0.4120286874988986270259 ...
    0.1584889157959357468838 ...
    0.0307800338725460822287 ...
    0.0027780688429127758961 ...
    1.000044412324998681273E-4 ...
    1.059115547711066635775E-6 ...
    1.52247580425351702016E-9];

switch order
    case 13
        alpha = alpha13;
    case 14
        alpha = alpha14;
    case 15
        alpha = alpha15;
end
% Algo
val = 0;
for i=1:order
    val = val + alpha(i)*f(i);
end
val =  invsqrtpi * val;


end